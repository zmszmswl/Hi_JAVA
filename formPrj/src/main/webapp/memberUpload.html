<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>memberAjax.html</title>
</head>
<style>
form {
	border: 2px solid green;
}

form>label {
	display: inline-block;
	width: 25%;
	background-color: yellowgreen;
}

/* css 선택자 */
#memberName {
	background-color: aquamarine;
}

input[name="phone"] {
	background-color: skyblue;
}
</style>
<body>

	<form action="fileUpload" name="memberFrm" method="post" enctype ="multipart/form-data" >
		<label for="memberNo">회원번호</label> 
		<input type="number"name="memberNo" id="memberNo" readonly><br> 
		<label for="memberName">회원이름</label> 
		<input type="text" name="memberName"id="memberName"><br> 
		<label for="phone">연락처</label> <input
			type="text" name="phone" id="phone"><br> 
		<label for="address">주소</label> <input type="text" name="address" id="address"><br> <label for="birth">생년월일</label> <input
			type="date" name="birth" id="birth"><br> 
		<label for="image">사진</label> <input type="file" name="image" id="image"><br>

		<input type="submit" value="추가"> <input type="reset"
			value="초기화"> <input type="button" value="선택삭제" id="deleteSel">
		<input type="button" value="수정" id="modify">

	</form>

	<div id="show">
		<table border="1">
			<thead>
				<tr>
					<th>회원번호</th>
					<th>회원이름</th>
					<th>연락처</th>
					<th>주소</th>
					<th>생년월일</th>
					<th>사진</th>
					<th>삭제</th>
					<th>선택삭제</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
	<script>
    
    // 리스트 출력.
    let ajax = new XMLHttpRequest();
    ajax.open('get','member?cmd=list');
    ajax.send();
    ajax.onload = function() {
    	let data = JSON.parse(this.responseText)
    	
    	let tbody = document.querySelector('#show tbody');
    	data.forEach(member => {
    			tbody.append(makeTr(member));		
    	})
    }
    
    let fields = ['membNo', 'membName','membPhone','membAddr','membBirth','membImage'];
    
    // 회원정보 => tr 생성
    function makeTr(member) { 
    	let tr = document.createElement('tr');
    	tr.setAttribute('id', member.membNo); // tr의 attribute 중에 id를 활용.
    	// tr.addEventListener('click', showDetail );
    	fields.forEach(field => {  // 배열에 있는 갯수만큼 반복하겠습니다
    		let td = document.createElement('td');
    	// null, 0, undefined, '' => false 이외 true
    		td.innerHTML = member[field] ?
    				(field == 'membImage' ? '<img width = "60px" src = "images/' + member[field] +'">' : member[field]) : '';  // 공란이 아니면 필드에 이미지 있나 물어보고 없으면 노이미지, 아니면 '', 그 이외의것은 '' 
    		// td.innerHTML = member[field] ?  member[field] : '';
    		// 참이면 앞에값 아니면 뒤의값을 실행하겠다는 삼항연산자. 없으면 이미지와 그 이외의 항목들과 구분하고싶음 없는 값 중에서 맴버이미지 속성이면, 이미지 항목이면 'no img' 나머지 항목이면 ''  // 삼항연산자 뒤가 없으면 undifined 값이나옴.
    		tr.append(td);
    	})
    	
    	// 삭제버튼 
    	let btn = document.createElement('button');
    	btn.innerHTML = '삭제';
    	// btn.addEventListener('click', rowDelete, false); // 이벤트 전파방식으로 3번째 값을 줄 수 있는데 하위요소에서 상위요소로 가는 default false 버블링
    	let td = document.createElement('td');
    	td.append(btn);
    	tr.append(td);
    	
    	// 체크박스 input type ='checkbox'
    	let checkbox = document.createElement('input');
    	checkbox.setAttribute('type','checkbox');
    	// checkbox.addEventListner('checked', false);
    	td = document.createElement('td');
    	td.append(checkbox);
    	tr.append(td);
  	
    	return tr;
    }
    
    	</script>
</body>
</html>